---
title: "Biofilm_CV,Chl,Resp"
author: "Anna Vincent"
date: "10/23/2018"
output: html_document
---

##Loading Package Library
Install and load packages needed for biofilm analyses - CV, Chl, Resp

```{r Library, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)

##Loading Packages
# ipak function: install and load multiple R packages.
# checks to see if packages are installed. Install them if they are not, then load them into the R session.
ipak <- function(pkg){
    new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
    if (length(new.pkg)) 
        install.packages(new.pkg, dependencies = TRUE, repos='http://cran.us.r-project.org')
    sapply(pkg, require, character.only = TRUE)
}
# Package list.  Contains all needed packages as a this writing.  To update, simply add new package name to the list!
packages <- c("ggplot2", 
              "plyr", 
              "reshape2", 
              "RColorBrewer", 
              "scales", 
              "grid",
              "VennDiagram",
              "bibtex",
              "vegan",
              "RAM",
              "tidyr",
              "Rmisc",
              "glue",
              "reshape",
              "reshape2",
              "lemon",
              "gapminder",
              "magrittr",
              "dplyr",
              "ggpubr",
              "gridExtra",
              "patternplot",
              "tibble",
              "gplots",
              "broom",
              "data.table",
              "devtools")
ipak(packages)

```

## Load CV raw data into R
Load CV raw data into R

```{r CV data}
CrystalViolet.df<-read.csv(file="CV_RawData.csv")

```

```{r OD Plot_OLD_Pre-dilution} 

CV_Plot_Pre_Dilution<-ggplot(CrystalViolet.df,aes(x=SITE,y=OPTICAL_DENSITY,group=SITE,shape=SUBSTRATE,color=SUBSTRATE))+
  geom_jitter(size=3)+
  theme_classic()+
  theme(legend.position=c(.2,.2),
        legend.direction = "horizontal",
        legend.title=element_blank(),
        axis.text=element_text(size=12),
        axis.title=element_text(size=12),
        legend.text=element_text(size=12),
        strip.background = element_blank(),
        strip.placement = "outside")+
  geom_boxplot(alpha=0.5)+
  labs(y=bquote('Optical Density ('~cm^-2~')'),x='Site')+
  facet_grid(~LOCATION, switch= "x", scales = "free_x", space = "free_x")

CV_Plot_Pre_Dilution

ggsave("CV_Plot_Pre_Dilution.jpeg", device = "jpeg", width = 12, height = 8.5, units = "in")

```


##Read in Chl-a raw data

```{r Chl data}
Chlorophyll.df<-read.csv(file="Chl_RawData.csv")
```

##Create new column for Chlorophyll measurement
Chlorophyll measured using before and after acidification Abs readings

```{r Chlorophyll calculation}
Chlorophyll.df$CHLOROPHYLL =abs(286 * (((abs(Chlorophyll.df$X650B)-abs(Chlorophyll.df$X750B))-(abs(Chlorophyll.df$X650A)-abs(Chlorophyll.df$X750A))*5)/Chlorophyll.df$SUBSTRATE_AREA))
```

##Create plot of Chlorophyll data

```{r Chl-a Plot}
Chl_Plot<-ggplot(Chlorophyll.df,aes(x=SITE,y=CHLOROPHYLL,group=SITE,shape=SUBSTRATE,color=SUBSTRATE))+
  geom_jitter(size=3)+
  theme_classic()+
  theme(legend.position=c(.2,.9),
        legend.direction = "horizontal",
        legend.title=element_blank(),
        axis.text=element_text(size=12),
        axis.title=element_text(size=12),
        legend.text=element_text(size=12),
        strip.background = element_blank(),
        strip.placement = "outside")+
  geom_boxplot(alpha=0.5)+
  labs(y=bquote('Chlorophyll ('~cm^-2~')'),x='Site')+
  facet_grid(~LOCATION, switch= "x", scales = "free_x", space = "free_x")

Chl_Plot

ggsave("Chl_Plot.jpeg", device = "jpeg", width = 12, height = 8.5, units = "in")
```

#Read in Optical Density data for Post-dilution biomass analysis

```{r OD data}
OpticalDensity<-read.csv(file="OD_RawData.csv")

```

```{r OD data summary and stats}

summary(OpticalDensity)
tapply(OpticalDensity$OPTICAL_DENSITY, OpticalDensity$SITE, OpticalDensity$SUBSTRATE, mean)
```


```{r OD_Plot_Post-Dilution}

OD_Plot_bar<-ggplot(OpticalDensity.df, aes(fill=SUBSTRATE, y=OPTICAL_DENSITY, x=SITE))+
  geom_bar(position="dodge", stat="identity")
  theme_classic()+
  theme(legend.position=c(.8,.9),
        legend.direction = "horizontal",
        legend.title=element_blank(),
        axis.text=element_text(size=12),
        axis.title=element_text(size=12),
        legend.text=element_text(size=12),
        strip.background = element_blank(),
        strip.placement = "outside")+
  labs(y=bquote('Optical Density ('~cm^-2~')'),x='Site')+
  facet_grid(~LOCATION, switch= "x", scales = "free_x", space = "free_x")

OD_Plot_bar

ggsave("OD_Plot_bar.jpeg", device = "jpeg", width = 12, height = 8.5, units = "in")
```



